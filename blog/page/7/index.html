<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta content="initial-scale=1" name="viewport" /><title>ROM - Blog</title><meta content="summary" name="twitter:card" /><meta content="@rom_rb" name="twitter:site" /><meta content="/blog/page/7/" name="og:url" /><meta content="ROM - Blog" name="og:title" /><meta content="http://rom-rb.org/images/logo--card.png" name="og:image" /><meta content="An open-source persistence and mapping toolkit for Ruby built for speed and simplicity." name="og:description" /><link href="/assets/stylesheets/all.css" rel="stylesheet" /><script src="/assets/javascripts/all.js"></script></head><body class="blog blog_page blog_page_7 blog_page_7_index"><div class="sponsorship-banner">Weâ€™re taking ROM to the next level, and we need your help.<a href="https://sponsor.hanamirb.org"><span>Become a patron today</span></a></div><div class="page"><div class="grid"><header class="header"><div class="header__logo"><a href="/" class="header__logo__link">Ruby Object Mapper</a></div><div class="header__menu-toggler" id="navigation__toggler"><span class="fa fa-navicon"></span></div><div class="header__menu" id="navigation__items"><nav class="menu"><ul class="menu__items"><li class="menu__item"><a href="/learn" class="menu__item__link">Learn</a></li><li class="menu__item"><a href="/guides" class="menu__item__link">Guides</a></li><li class="menu__item"><a href="/api" class="menu__item__link">API</a></li><li class="menu__item"><a href="/blog" class="menu__item__link--is-active">Blog</a></li><li class="menu__item"><a href="/contribute" class="menu__item__link">Contribute</a></li><li class="menu__item"><a href="https://discourse.rom-rb.org" class="menu__item__link">Discuss</a></li><li class="menu__item"><a href="/status" class="menu__item__link">Status</a></li><li class="menu__item--last"><a href="https://opencollective.com/rom" class="menu__item__link">Donate</a></li></ul></nav></div></header><div class="page__sidebar"><div class="sidebar"><h2 class="sidebar__header--first">Blog</h2><h3 class="sidebar__header">Latest Posts</h3><ul class="sidebar__items"><li class="sidebar__item"><a href="/blog/rom-5-1-released/" class="sidebar__link">ROM 5.1 released</a></li><li class="sidebar__item"><a href="/blog/announcing-rom-http/" class="sidebar__link">Announcing rom-http</a></li><li class="sidebar__item"><a href="/blog/rom-5-0-and-rom-sql-3-0-released/" class="sidebar__link">rom 5.0.0 and rom-sql 3.0.0 released</a></li><li class="sidebar__item"><a href="/blog/announcing-rom-factory/" class="sidebar__link">Announcing rom-factory</a></li><li class="sidebar__item"><a href="/blog/rom-4-0-released/" class="sidebar__link">ROM 4.0.0 released</a></li></ul><h3 class="sidebar__header">Browse Tags</h3><ul class="sidebar__items"><li class="sidebar__item"><a href="/blog/tags/release" class="sidebar__link">release</a></li><li class="sidebar__item"><a href="/blog/tags/announcement" class="sidebar__link">announcement</a></li><li class="sidebar__item"><a href="/blog/tags/http" class="sidebar__link">http</a></li><li class="sidebar__item"><a href="/blog/tags/repository" class="sidebar__link">repository</a></li><li class="sidebar__item"><a href="/blog/tags/oss" class="sidebar__link">oss</a></li><li class="sidebar__item"><a href="/blog/tags/support" class="sidebar__link">support</a></li></ul><h3 class="sidebar__header">Subscribe</h3><p><a href="#" class="button--secondary"><span class="fa fa-rss"></span> RSS</a></p></div></div><div class="page__content"><div class="content"><article class="article"><h1 class="article__title"><a href="/blog/sustainable-development-campaign/" class="article__title__link">Sustainable Development Campaign</a></h1><div class="article__metadata">Posted by <a href="https://twitter.com/_solnic_">Piotr Solnica</a> on August 04, 2015 under <ul class="article__tags"><li class="article__tag"><a href="/blog/tags/oss">oss</a></li><li class="article__tag"><a href="/blog/tags/support">support</a></li></ul></div><p>ROM has been in development for a couple of years already, in fact, its <a href="https://github.com/solnic/rom-relation/tree/pre-mapper-extraction">early prototype</a> was built in 2012, and has gone through multiple phases before the final architecture was introduced in October last year. This has been a huge effort which resulted in the creation of many smaller libraries and, of course, ROM itself.</p>

<p>One of the main reasons that this project was started was to discover a better way of writing Ruby code that would result in a cleaner architecture for the systems we&#39;re building. The Ruby ecosystem has mostly been shaped by the Active Record pattern introduced in the Rails framework, but ROM tries to move away from the common approach, so that it&#39;s easier to build <strong>and grow</strong> systems built in Ruby.</p>

<p>It&#39;s been an interesting journey with lots of experimentation, and we are getting there, as ROM is approaching 1.0.0.</p>

<p>There are a few mind-shifting aspects of ROM which are worth consideration as general programming guidelines in Ruby:</p>

<ul>
<li>Prefer simple objects that don&#39;t change (mutate) and have a single purpose to exist</li>
<li>Prefer interfaces that have no side-effects</li>
<li>Embrace simple data structures rather than complicated objects that mix data and behavior</li>
<li>Prefer objects over classes, and always treat dependencies explicitly</li>
<li>Pay attention to boundaries and proper separation of concerns</li>
</ul>

<p>Those guideliness have led to the decision that ROM will not be a typical Object Relational Mapper which tries to hide your database behind walls of complicated and leaky abstractions and pretend that &quot;you can just use objects&quot;. This is the reason why ROM gives you a powerful interface to use your database effectively; which can be levaraged to design your systems with simpler data structures in mind and decouple your application layer from persistence concerns.</p>

<p>Such an approach has a significant impact on <strong>lowering complexity</strong> of your application layer.</p>
<h2 id="growing-the-ecosystem" class="hd"><a name="growing-the-ecosystem" class="anchor" href="#growing-the-ecosystem">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>Growing The Ecosystem</h2>
<p>ROM is already a big project; if you consider its lower level libraries, over 14 adapters and integration with 3 frameworks. But it goes beyond that - other libraries are being developed that are based the on same programming principles. It is absolutely amazing to see that happening. The ecosystem is growing.</p>

<p>We have reached a point where ROM needs a sustainable pace of development, so that following things can happen:</p>

<ul>
<li>Reach 1.0.0 in September</li>
<li>Extract re-usable APIs into separate libraries so that other projects can benefit from them</li>
<li>Improve existing adapters to be production-ready (the more the merrier)</li>
<li>Address all known issues in a timely fashion</li>
<li>Support users in multiple channels</li>
<li>Establish a solid release process with a CI setup that can help in developing adapters and extensions</li>
</ul>

<p>In order to be able to do all of that we need your support.</p>
<h2 id="campaign-on-bountysource" class="hd"><a name="campaign-on-bountysource" class="anchor" href="#campaign-on-bountysource">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>Campaign on Bountysource</h2>
<p>Bountysource is a service that helps in raising funds for Open Source projects. Its latest feature, called Salt, allows sustainable fundraising on a monthly basis. This makes it possible to support a steady pace of development - which is crucial for a complex project like ROM.</p>

<p>If you&#39;d like to see ROM grow faster, please consider supporting the project through <a href="https://salt.bountysource.com/teams/rom-rb">the campaign</a>.</p>

<p>We want to take the project to the next level with this campaign and hope to expand the team so that more people can work continuously on ROM. We are happy to use the funds to sponsor work on ROM itself and also on any other library that the project could benefit from.</p>

<blockquote>
<h2 id="update" class="hd"><a name="update" class="anchor" href="#update">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>UPDATE</h2>
<p>We moved our donation campaign to <a href="https://opencollective.com/rom">opencollective.com/rom</a></p>
</blockquote>
<h2 id="what-39-s-in-it-for-you" class="hd"><a name="what-39-s-in-it-for-you" class="anchor" href="#what-39-s-in-it-for-you">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>What&#39;s in it for you?</h2>
<p>There are many ways in which you and your company can benefit from ROM <em>today</em>, but there&#39;s still a lot to be done to make ROM simpler to use for the common application use-case. This includes adding convenient, high-level abstractions as well as providing great documentation and other resources that would teach people how to use ROM.</p>

<p>If you&#39;re interested in the project but it still feels &quot;weird&quot; or &quot;too complicated&quot;, this is exactly the reason that the campaign was started. ROM <em>should be accessible for everybody</em>, including less experienced developers. Not only do we want to promote ROM, but also, the general approach to writing Ruby code, which we believe results in a better and more maintainable code-base.</p>

<p>For any questions or concerns, please do not hesitate to <a href="https://twitter.com/_solnic_">get in touch</a>.</p>
<hr /></article><article class="article"><h1 class="article__title"><a href="/blog/rom-0-8-0-released/" class="article__title__link">ROM 0.8.0 Released</a></h1><div class="article__metadata">Posted by <a href="https://twitter.com/_solnic_">Piotr Solnica</a> on June 22, 2015 under <ul class="article__tags"><li class="article__tag"><a href="/blog/tags/release">release</a></li><li class="article__tag"><a href="/blog/tags/announcement">announcement</a></li></ul></div><p>We&#39;re very happy to announce the release of Ruby Object Mapper 0.8.0. This release ships with the support for nested input for commands and many improvements in mappers. You can look at <a href="https://github.com/rom-rb/rom/blob/main/CHANGELOG.md#v070-2015-06-22">the changelog</a> for the full overview.</p>

<p>Apart from ROM 0.8.0 release there are also updates of the following gems:</p>

<ul>
<li>rom-sql 0.5.2 which comes with improved migration tasks that no longer require env finalization <a href="https://github.com/rom-rb/rom-sql/blob/main/CHANGELOG.md#v070-2015-06-22">CHANGELOG</a></li>
<li>rom-rails 0.4.0 with the support for embedded validators <a href="https://github.com/rom-rb/rom-rails/blob/main/CHANGELOG.md#v070-2015-06-22">CHANGELOG</a></li>
</ul>

<p>There are 2 new adapters added to the rom-rb organization so check them out:</p>

<ul>
<li><a href="https://github.com/rom-rb/rom-couchdb">rom-couchdb</a></li>
<li><a href="https://github.com/rom-rb/rom-git">rom-git</a></li>
</ul>
<h2 id="support-for-nested-input" class="hd"><a name="support-for-nested-input" class="anchor" href="#support-for-nested-input">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>Support For Nested Input</h2>
<p>ROM commands are now even more powerful by allowing composition of multiple commands into one that can receive a nested input which will be used to insert data into multiple relations. This feature is compatible with combined relation mapping which means you can pipe results from a combined command through mappers just like in case of combined relations.</p>

<p>When do you want to use this feature? Every time you want to persist entire object graph, in example a post with its tags or a user with an address.</p>

<p>Here&#39;s a complete example of using combined commands with a mapper:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="no">ROM</span><span class="p">.</span><span class="nf">setup</span><span class="p">(</span><span class="ss">:sql</span><span class="p">,</span> <span class="s1">'postgres://localhost/rom'</span><span class="p">)</span>

<span class="no">ROM</span><span class="o">::</span><span class="no">SQL</span><span class="p">.</span><span class="nf">gateway</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">create_table</span> <span class="ss">:posts</span> <span class="k">do</span>
  <span class="n">primary_key</span> <span class="ss">:id</span>
  <span class="n">column</span> <span class="ss">:title</span><span class="p">,</span> <span class="no">String</span>
<span class="k">end</span>

<span class="no">ROM</span><span class="o">::</span><span class="no">SQL</span><span class="p">.</span><span class="nf">gateway</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">create_table</span> <span class="ss">:tags</span> <span class="k">do</span>
  <span class="n">primary_key</span> <span class="ss">:id</span>
  <span class="n">foreign_key</span> <span class="ss">:post_id</span><span class="p">,</span> <span class="ss">:posts</span><span class="p">,</span> <span class="ss">null: </span><span class="kp">false</span>
  <span class="n">column</span> <span class="ss">:name</span><span class="p">,</span> <span class="no">String</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Posts</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Relation</span><span class="p">[</span><span class="ss">:sql</span><span class="p">]</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Tags</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Relation</span><span class="p">[</span><span class="ss">:sql</span><span class="p">]</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">CreatePost</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Commands</span><span class="o">::</span><span class="no">Create</span><span class="p">[</span><span class="ss">:sql</span><span class="p">]</span>
  <span class="n">relation</span> <span class="ss">:posts</span>
  <span class="n">result</span> <span class="ss">:one</span>
  <span class="n">register_as</span> <span class="ss">:create</span>
  <span class="n">input</span> <span class="no">Transproc</span><span class="p">(</span><span class="ss">:accept_keys</span><span class="p">,</span> <span class="p">[</span><span class="ss">:title</span><span class="p">])</span> <span class="c1"># filters out `:tags` key</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">CreateTag</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Commands</span><span class="o">::</span><span class="no">Create</span><span class="p">[</span><span class="ss">:sql</span><span class="p">]</span>
  <span class="n">relation</span> <span class="ss">:tags</span>
  <span class="n">register_as</span> <span class="ss">:create</span>
  <span class="n">input</span> <span class="no">Transproc</span><span class="p">(</span><span class="ss">:accept_keys</span><span class="p">,</span> <span class="p">[</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:post_id</span><span class="p">])</span>
  <span class="n">associates</span> <span class="ss">:post</span><span class="p">,</span> <span class="ss">key: </span><span class="p">[</span><span class="ss">:post_id</span><span class="p">,</span> <span class="ss">:id</span><span class="p">]</span> <span class="c1"># automatically sets FK value</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">PostMapper</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Mapper</span>
  <span class="n">relation</span> <span class="ss">:posts</span>
  <span class="n">register_as</span> <span class="ss">:entity</span>

  <span class="n">combine</span> <span class="ss">:tags</span><span class="p">,</span> <span class="ss">on: </span><span class="p">{</span> <span class="ss">id: :post_id</span> <span class="p">}</span>
<span class="k">end</span>

<span class="n">rom</span> <span class="o">=</span> <span class="no">ROM</span><span class="p">.</span><span class="nf">finalize</span><span class="p">.</span><span class="nf">env</span>

<span class="n">create_post_with_tags</span> <span class="o">=</span> <span class="n">rom</span>
  <span class="p">.</span><span class="nf">command</span><span class="p">([{</span> <span class="ss">post: :posts</span> <span class="p">},</span> <span class="p">[</span><span class="ss">:create</span><span class="p">,</span> <span class="p">[</span><span class="ss">:tags</span><span class="p">,</span> <span class="p">[</span><span class="ss">:create</span><span class="p">]]]])</span>
  <span class="p">.</span><span class="nf">as</span><span class="p">(</span><span class="ss">:entity</span><span class="p">)</span>

<span class="n">create_post_with_tags</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span>
  <span class="ss">post: </span><span class="p">{</span> <span class="ss">title: </span><span class="s1">'Hello World'</span><span class="p">,</span> <span class="ss">tags: </span><span class="p">[{</span> <span class="ss">name: </span><span class="s1">'red'</span> <span class="p">},</span> <span class="p">{</span> <span class="ss">name: </span><span class="s1">'green'</span> <span class="p">}]</span> <span class="p">}</span>
<span class="p">).</span><span class="nf">to_a</span>
<span class="c1"># [</span>
<span class="c1">#   {</span>
<span class="c1">#     :id =&gt; 1,</span>
<span class="c1">#     :title =&gt; "Hello World",</span>
<span class="c1">#     :tags =&gt; [</span>
<span class="c1">#       { :id=&gt;1, :post_id=&gt;1, :name=&gt;"red" },</span>
<span class="c1">#       { :id=&gt;2, :post_id=&gt;1, :name=&gt;"green" }</span>
<span class="c1">#      ]</span>
<span class="c1">#   }</span>
<span class="c1"># ]</span>
</code></pre></div><h2 id="mapper-steps" class="hd"><a name="mapper-steps" class="anchor" href="#mapper-steps">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>Mapper Steps</h2>
<p>Transforming data with mappers can be really complex and sometimes you may want to define multiple mapping steps. That&#39;s why we introduced a new interface in Mapper DSL where you can do just that:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="k">class</span> <span class="nc">UserMapper</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Mapper</span>
  <span class="n">step</span> <span class="k">do</span>
    <span class="n">attribute</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">from: :user_id</span>
    <span class="n">attribute</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">from: :user_name</span>
  <span class="k">end</span>

  <span class="n">step</span> <span class="k">do</span>
    <span class="n">wrap</span> <span class="ss">:details</span> <span class="k">do</span>
      <span class="n">attribute</span> <span class="ss">:name</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">mapper</span> <span class="o">=</span> <span class="no">UserMapper</span><span class="p">.</span><span class="nf">build</span>

<span class="n">mapper</span><span class="p">.</span><span class="nf">call</span><span class="p">([{</span> <span class="ss">user_id: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">user_name: </span><span class="s1">'Jane'</span> <span class="p">}])</span>
<span class="c1"># [{ :id =&gt; 1, :details =&gt; { :name =&gt; "Jane" } }]</span>
</code></pre></div>
<p>Typically you want to use this feature when mapping logic is too complex to be expressed using nested blocks. It&#39;s especially useful when dealing with multiple group/ungroup/wrap/unwrap/fold/unfold operations that simply cannot be defined as a deeply nested mapping definition block.</p>
<h2 id="new-mapping-transformations" class="hd"><a name="new-mapping-transformations" class="anchor" href="#new-mapping-transformations">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>New Mapping Transformations</h2>
<p>We have 3 new transformations <code>fold</code>, <code>unfold</code> and <code>ungroup</code> which makes mappers even more powerful.</p>

<p>Folding can be used to collapse values from multiple tuples under a single array attribute:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="k">class</span> <span class="nc">PostFoldMapper</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Mapper</span>
  <span class="n">fold</span> <span class="ss">tag_list: </span><span class="p">[</span><span class="ss">:tag_name</span><span class="p">]</span>
<span class="k">end</span>

<span class="n">mapper</span> <span class="o">=</span> <span class="no">PostFoldMapper</span><span class="p">.</span><span class="nf">build</span>

<span class="nb">puts</span> <span class="n">mapper</span><span class="p">.</span><span class="nf">call</span><span class="p">([</span>
  <span class="p">{</span> <span class="ss">title: </span><span class="s1">'Hello World'</span><span class="p">,</span> <span class="ss">tag_name: </span><span class="s1">'red'</span> <span class="p">},</span>
  <span class="p">{</span> <span class="ss">title: </span><span class="s1">'Hello World'</span><span class="p">,</span> <span class="ss">tag_name: </span><span class="s1">'green'</span> <span class="p">}</span>
<span class="p">]).</span><span class="nf">inspect</span>
<span class="c1"># [{:title=&gt;"Hello World", :tag_list=&gt;["red", "green"]}]</span>
</code></pre></div>
<p>Unfolding is, unsurprisingly, an inversion of folding:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="k">class</span> <span class="nc">PostUnfoldMapper</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Mapper</span>
  <span class="n">unfold</span> <span class="ss">:tag_name</span><span class="p">,</span> <span class="ss">from: :tag_list</span>
<span class="k">end</span>

<span class="n">mapper</span> <span class="o">=</span> <span class="no">PostUnfoldMapper</span><span class="p">.</span><span class="nf">build</span>

<span class="nb">puts</span> <span class="n">mapper</span><span class="p">.</span><span class="nf">call</span><span class="p">([{</span> <span class="ss">title: </span><span class="s1">'Hello World'</span><span class="p">,</span> <span class="ss">tag_list: </span><span class="p">[</span><span class="s1">'red'</span><span class="p">,</span> <span class="s1">'green'</span><span class="p">]</span> <span class="p">}]).</span><span class="nf">inspect</span>
<span class="c1"># [{:tag_name=&gt;"red", :title=&gt;"Hello World"}, {:tag_name=&gt;"green", :title=&gt;"Hello World"}]</span>
</code></pre></div>
<p>Now you can also ungroup tuples:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="k">class</span> <span class="nc">PostUngroupMapper</span> <span class="o">&lt;</span> <span class="no">ROM</span><span class="o">::</span><span class="no">Mapper</span>
  <span class="n">ungroup</span> <span class="ss">:tags</span> <span class="k">do</span>
    <span class="n">attribute</span> <span class="ss">:tag_name</span><span class="p">,</span> <span class="ss">from: :name</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">mapper</span> <span class="o">=</span> <span class="no">PostUngroupMapper</span><span class="p">.</span><span class="nf">build</span>

<span class="nb">puts</span> <span class="n">mapper</span><span class="p">.</span><span class="nf">call</span><span class="p">([</span>
  <span class="p">{</span> <span class="ss">title: </span><span class="s1">'Hello World'</span><span class="p">,</span> <span class="ss">tags: </span><span class="p">[{</span> <span class="ss">name: </span><span class="s1">'red'</span> <span class="p">},</span> <span class="p">{</span> <span class="ss">name: </span><span class="s1">'green'</span> <span class="p">}]</span> <span class="p">}</span>
<span class="p">]).</span><span class="nf">inspect</span>
<span class="c1"># [{:tag_name=&gt;"red", :title=&gt;"Hello World"}, {:tag_name=&gt;"green", :title=&gt;"Hello World"}]</span>
</code></pre></div><h2 id="guides" class="hd"><a name="guides" class="anchor" href="#guides">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>Guides</h2>
<p>ROM is growing really fast and there&#39;s a lot of functionality that is difficult to describe in API documentation. That&#39;s why we started a new <a href="http://rom-rb.org/guides">Guides</a> section on the official rom-rb.org website.</p>

<p>You can already find a lot of information about ROM setup, adapters, relations, commands and mappers. We&#39;ll be adding more content and improving existing documentation based on the feedback so please check them out and let us know what you think.</p>

<p>In the upcoming weeks you should also see new tutorials covering topics like building your own persistence layer with ROM, handling data import with ROM or how to use ROM with various JSON serializers like Roar or Yaks, so stay tuned!</p>
<h2 id="next-release" class="hd"><a name="next-release" class="anchor" href="#next-release">            <svg aria-hidden="true" height="16" width="16" version="1.1" viewBox="0 0 16 16">
            <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
            </svg>
</a>Next Release</h2>
<p>We have a pretty good understanding of what we want to achieve with the next 0.9.0 release which will improve the internal architecture of ROM. We&#39;re planning to split <code>rom</code> gem into <a href="https://github.com/rom-rb/rom/issues/256">smaller pieces</a> and introduce cleaner and more explicit interfaces for setting up ROM.</p>

<p>Another planned change is introducing <a href="https://github.com/rom-rb/rom/issues/193">Policy Over Configuration</a> API which should improve ROM configuration and handling various conventions.</p>

<p>This release will be a big step towards 1.0.0 which is scheduled for September (yes, this year ;)).</p>
<hr /></article><ul class="inline-buttons inline-buttons--centered"><li class="inline-buttons__button"><a href="/blog/page/8/" class="button"><span class="fa fa-arrow-left"></span></a></li><li class="inline-buttons__spacer inline-buttons__spacer--wide"><p><strong>7 of 9</strong></p></li><li class="inline-buttons__button inline-buttons__button"><a href="/blog/page/6/" class="button"><span class="fa fa-arrow-right"></span></a></li></ul></div><section class="feedback"><div class="inline-buttons"><a href="https://github.com/rom-rb/rom-rb.org/blob/main/source/blog/index.html.slim" class="button">Edit on GitHub</a><a href="https://github.com/rom-rb/rom-rb.org/issues/new?labels=feedback&amp;assignees=solnic&amp;title=Feedback%20on%20ROM%20-%20Blog" class="button">Provide feedback!</a></div></section></div></div></div><div class="footer"><div class="grid"><div class="footer__fine-print"><div class="footer__fine-print__copyright"><small>&copy; 2014-2025 Ruby Object Mapper. Design by <a href="https://github.com/angeloashmore">@angeloashmore</a>. Logo by <a href="https://github.com/kapowaz">@kapowaz</a>.</small></div><div class="footer__fine-print__social"><a href="https://github.com/rom-rb/rom" class="footer__fine-print__social__icon"><span class="fa fa-github-alt"></span></a><a href="https://twitter.com/rom_rb" class="footer__fine-print__social__icon--last"><span class="fa fa-twitter"></span></a></div></div></div></div></body></html>